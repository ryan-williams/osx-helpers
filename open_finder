#!/usr/bin/env bash
# Open Finder at the given path(s); resolve files to their parent directories.

finder=
paths=("/Applications/Finder.app" "/System/Library/CoreServices/Finder.app")
for path in "${paths[@]}"; do
  if [ -d "$path" ]; then
    finder="$path"
    break
  fi
done
if [ -z "$finder" ]; then
  echo "Finder not found at ${paths[*]}" >&2
  exit 1
fi

args=()
for arg in "${@:-.}"; do
  if [ -f "$arg" ]; then
    args+=("$(dirname "$arg")")
  else
    args+=("$arg")
  fi
done
open -a "$finder" "${args[@]}"
